# 利用模板零基础写签到脚本（金山文档）

# **简述**

本文适用于零开发经验、无代码基础的人参考。

本文介绍如何向聚合脚本中新增自己编写的脚本。

将修改的内容提交到github中，即可成为贡献者。

欢迎各位开发者或期望成为开发者的朋友完善此模版！

自己写签到脚本步骤简要（两步走）：

1.改UPDATE.js脚本

2.改TEMPLATE.js模板脚本（三小步）

文章中的代码已放入github仓库中，更多及最新代码将会在仓库中更新

```
https://github.com/imoki
```

# **聚合脚本文件介绍**

![1.webp](%E5%88%A9%E7%94%A8%E6%A8%A1%E6%9D%BF%E9%9B%B6%E5%9F%BA%E7%A1%80%E5%86%99%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC%EF%BC%88%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%EF%BC%89%2012d1fc355aa9817391cdd1f5031ad5da/eef1a7b5-3bbd-4687-956a-b96538b9104a.png)

![2.webp](%E5%88%A9%E7%94%A8%E6%A8%A1%E6%9D%BF%E9%9B%B6%E5%9F%BA%E7%A1%80%E5%86%99%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC%EF%BC%88%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%EF%BC%89%2012d1fc355aa9817391cdd1f5031ad5da/822af2d0-c138-4feb-8519-0bd24b4b0320.png)

在"polymerization"文件夹内的脚本统称为"聚合脚本"。

UPDATE.js脚本（更新脚本）能够自动创建表格、自动填充缺失内容，不会覆盖原有数据，除此脚本外，都是自动化签到脚本。

TEMPLATE.js脚本（模板脚本）根据此模板制作签到脚本，实际的签到脚本与此模板基本相同。

# **实际步骤（两步走）**

![3.webp](%E5%88%A9%E7%94%A8%E6%A8%A1%E6%9D%BF%E9%9B%B6%E5%9F%BA%E7%A1%80%E5%86%99%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC%EF%BC%88%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%EF%BC%89%2012d1fc355aa9817391cdd1f5031ad5da/242f4bf7-f5ba-4fbc-8cc1-3371713b9d7c.png)

1.向UPDATE.js脚本中写入新脚本的表格配置数据。

如原来表格信息是这样的：

```
// 分配置表名称var subConfigWorkbook=['aliyundrive_multiuser','52pojie'];// CONFIG表内容var configContent=[  ['工作表的名称','备注','只推送失败消息（是/否）','推送昵称（是/否）'],  ['aliyundrive_multiuser','阿里云盘（多用户版）','否','是'],  ['52pojie','吾爱破解','否','是'],]
```

假设需要添加某雪论坛的脚本（英文mouxue）,则修改为如下。

```
// 分配置表名称var subConfigWorkbook=['aliyundrive_multiuser','52pojie','noteyoudao'];// CONFIG表内容var configContent=[  ['工作表的名称','备注','只推送失败消息（是/否）','推送昵称（是/否）'],  ['aliyundrive_multiuser','阿里云盘（多用户版）','否','是'],  ['52pojie','吾爱破解','否','是'],  ['mouxue','某雪论坛','否','是'],]
```

此时若运行UPDATE.js脚本，则会在CONFIG表（主配置表）中看到新增了一行有道云笔记的配置，并且新增了名称为mouxue的表。

![4.webp](%E5%88%A9%E7%94%A8%E6%A8%A1%E6%9D%BF%E9%9B%B6%E5%9F%BA%E7%A1%80%E5%86%99%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC%EF%BC%88%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%EF%BC%89%2012d1fc355aa9817391cdd1f5031ad5da/e47737b4-0ff7-44d0-945f-3daa89720c52.png)

2.根据TEMPLATE.js模板新建自动化脚本（三小步）

![5.webp](%E5%88%A9%E7%94%A8%E6%A8%A1%E6%9D%BF%E9%9B%B6%E5%9F%BA%E7%A1%80%E5%86%99%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC%EF%BC%88%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%EF%BC%89%2012d1fc355aa9817391cdd1f5031ad5da/98cc9bcf-c51f-4065-8496-648a772ab415.png)

在模板文件中，按Ctrl+F进行搜索，输入“修改这里”，就可以定位到要修改的地方了。仅有几处需要修改，根据模板内的说明可修改。

![8.webp](%E5%88%A9%E7%94%A8%E6%A8%A1%E6%9D%BF%E9%9B%B6%E5%9F%BA%E7%A1%80%E5%86%99%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC%EF%BC%88%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%EF%BC%89%2012d1fc355aa9817391cdd1f5031ad5da/8.webp)

能定位到脚本开头有几处需要修改的地方，名称需要和步骤1中新增的表名称一致如上述的mouxue.js。

![7.webp](%E5%88%A9%E7%94%A8%E6%A8%A1%E6%9D%BF%E9%9B%B6%E5%9F%BA%E7%A1%80%E5%86%99%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC%EF%BC%88%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%EF%BC%89%2012d1fc355aa9817391cdd1f5031ad5da/63f73943-ae5d-4b9f-82a1-5baff8fd5111.png)

能定位到脚本末尾有几处需要修改的地方，根据抓包的内容（例如抓取签到的包，软件抓包也不需要代码基础，IOS端可用Stream工具、安卓端可用小黄鸟、PC端可用burp）

![8.webp](%E5%88%A9%E7%94%A8%E6%A8%A1%E6%9D%BF%E9%9B%B6%E5%9F%BA%E7%A1%80%E5%86%99%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC%EF%BC%88%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%EF%BC%89%2012d1fc355aa9817391cdd1f5031ad5da/336afad1-518c-4ac5-87dc-9677a95a5061.png)

修改header和data方法一句话：一切照抄包

第一小步：

这幅图片以安卓app的小黄鸟抓到的包为例，说明header填写的方式（data填写也一样，后文会以IOS抓的包为例）：

由于cookie的值将会从表格中获取，下方没加双引号的cookie是变量，不需要改动。

![10.webp](%E5%88%A9%E7%94%A8%E6%A8%A1%E6%9D%BF%E9%9B%B6%E5%9F%BA%E7%A1%80%E5%86%99%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC%EF%BC%88%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%EF%BC%89%2012d1fc355aa9817391cdd1f5031ad5da/8e95bfa6-aa39-4153-90db-48c7a10a029c.png)

第二小步：

这幅图片以安卓app的小黄鸟抓到的包为例，根据这里的url填入模板定位到的对应位置，根据是POST还是GET请求选择模板中对应的发送代码

![11.webp](%E5%88%A9%E7%94%A8%E6%A8%A1%E6%9D%BF%E9%9B%B6%E5%9F%BA%E7%A1%80%E5%86%99%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC%EF%BC%88%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%EF%BC%89%2012d1fc355aa9817391cdd1f5031ad5da/3fd8ef87-48fb-4b13-9b0d-7360b543335b.png)

![12.webp](%E5%88%A9%E7%94%A8%E6%A8%A1%E6%9D%BF%E9%9B%B6%E5%9F%BA%E7%A1%80%E5%86%99%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC%EF%BC%88%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%EF%BC%89%2012d1fc355aa9817391cdd1f5031ad5da/fdc1a6db-eef5-4b4c-96b9-88c5414546d7.png)

![13.webp](%E5%88%A9%E7%94%A8%E6%A8%A1%E6%9D%BF%E9%9B%B6%E5%9F%BA%E7%A1%80%E5%86%99%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC%EF%BC%88%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%EF%BC%89%2012d1fc355aa9817391cdd1f5031ad5da/22411164-0e51-4477-8713-b96621212283.png)

其中，如果是POST请求则从请求方式1和请求方式2中选一个，如果是GET请求，则直接使用请求方式3。（//双斜杠是注释，意思就是给自己看的，想写什么写什么，不会被执行。要用哪个请求方式就去掉它前方的双斜杠，另外两种不用的请求方式就删掉）

如果抓包到的POST请求中的请求体中没有data数据，那么就把data修改为空即可，如下，只有花括号里面什么都没有则置为空了：

```
  data = {
  }
```

第三小步：

根据响应数据自行修改。这一小步可能比较困难，比较灵活，但是仔细看规律还是比较明显，看下模板中的说明即可。

以某雪论坛为例子。按F12会唤起下方的开发者工具，然后点击“签到”按钮

![14.webp](%E5%88%A9%E7%94%A8%E6%A8%A1%E6%9D%BF%E9%9B%B6%E5%9F%BA%E7%A1%80%E5%86%99%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC%EF%BC%88%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%EF%BC%89%2012d1fc355aa9817391cdd1f5031ad5da/76a0c966-2bdc-4f69-ba16-b1d629ad182d.png)

就能看到“签到”的包，点击它就能看到响应的数据，这里以花括号、双引号和逗号组成的形式就是json的数据格式。以下图片是签到成功的响应。

![15.webp](%E5%88%A9%E7%94%A8%E6%A8%A1%E6%9D%BF%E9%9B%B6%E5%9F%BA%E7%A1%80%E5%86%99%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC%EF%BC%88%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%EF%BC%89%2012d1fc355aa9817391cdd1f5031ad5da/4e7f574a-1103-49b5-8daa-fe701a21bf55.png)

为了方便说明，这里的假设里如下的响应包例子。按照模板说明自行修改即可

```jsx
// 接收到的响应数据是json格式，如下，假设有2种情况
// 情况1：{"code": "0","message": "签到成功"}
// 情况2：{"code":"-1","message":"签到失败"}
```

![16.webp](%E5%88%A9%E7%94%A8%E6%A8%A1%E6%9D%BF%E9%9B%B6%E5%9F%BA%E7%A1%80%E5%86%99%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC%EF%BC%88%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%EF%BC%89%2012d1fc355aa9817391cdd1f5031ad5da/bba905bb-f4e1-4a12-822c-470481ffdc3b.png)

(如果确定发送请求包就是签到，不想看响应包了，想省事的话，上面的红色框里的内容直接删掉，改成如下图所示即可)。

```jsx
// 终极省事代码    
content = "签到成功 "    
messageSuccess += content;    
console.log(content)
```

![17.webp](%E5%88%A9%E7%94%A8%E6%A8%A1%E6%9D%BF%E9%9B%B6%E5%9F%BA%E7%A1%80%E5%86%99%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC%EF%BC%88%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%EF%BC%89%2012d1fc355aa9817391cdd1f5031ad5da/bb31e6d4-0e1e-4ba2-8197-32bef00a94da.png)

此时就成功创建新脚本了。

将修改的内容提交到github中即可成为贡献者。

（以下是IOS抓包的例子。说明填写的header和data从哪里来的。如果能看明白抓包内容，下方的教程可以忽略。）

上方的headers和data内容填什么，以及如何判断是get还是post请求，下方将进行说明。以IOS端的Stream抓包工具抓取到的内容为例。

1.判断get还是post请求

在每个包的最前方会有显示。

![18.webp](%E5%88%A9%E7%94%A8%E6%A8%A1%E6%9D%BF%E9%9B%B6%E5%9F%BA%E7%A1%80%E5%86%99%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC%EF%BC%88%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%EF%BC%89%2012d1fc355aa9817391cdd1f5031ad5da/8b5b69bb-ed3b-4500-a612-f98bf762943d.png)

如果是get请求，对应的代码则为

```
// 请求方式3：GET请求，无data数据。则用这个  
resp = HTTP.get(    url1,    { headers: headers }  );
```

如果是post请求，对应的代码则为

```jsx
// 请求方式1：POST请求，抓包的data数据格式是 {"aaa":"xxx","bbb":"xxx"} 。则用这个  
resp = HTTP.post(
    url1,    
    JSON.stringify(data),    
    { headers: headers }  
);
// // 请求方式2：POST请求，抓包的data数据格式是 aaa=xxx&bbb=xxx 。则用这个
// resp = HTTP.post(
//   url1,
//   data,
//   { headers: headers }
// );
```

2.获取headers

点入其中一个包，假设此包就是代表签到请求的包。为了方便查看，这里点击一下"编辑重放请求"（这一步可以忽略，仅是为了方便查看数据）

![19.webp](%E5%88%A9%E7%94%A8%E6%A8%A1%E6%9D%BF%E9%9B%B6%E5%9F%BA%E7%A1%80%E5%86%99%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC%EF%BC%88%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%EF%BC%89%2012d1fc355aa9817391cdd1f5031ad5da/425878b7-30c2-4494-a006-50965cc26dce.png)

如图所示在最开头链接行，对应代码中的url

- 

```
var url1 = "https://note.youdao.com/yws/mapi/user?method=checkin";
```

请求头部，对应代码中的headers。这里把前方的称为键，后方的称为值。一般情况下只有Cookie、Content-Type等少数需要，其余的可以不填写，保险起见也可以全部输入。

由于cookie的值将会从表格中获取，下方没加双引号的cookie是变量，不需要改动。

```jsx
headers = {  
	"Cookie": cookie,  
	"User-Agent": "YNote",
};
```

![20.webp](%E5%88%A9%E7%94%A8%E6%A8%A1%E6%9D%BF%E9%9B%B6%E5%9F%BA%E7%A1%80%E5%86%99%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC%EF%BC%88%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%EF%BC%89%2012d1fc355aa9817391cdd1f5031ad5da/c7e28b0d-d230-46a9-b7d6-120e0a3c5a5a.png)

3.获取data(如果是get请求是没有这个的，可以直接忽略)

为了查看方便，点击上方图片中"请求体"-"普通表单"。和headers类似，这里也分为键值对，可能也是只有少数几个需要，保险起见也可以全部输入。对应的代码为。

```jsx
data ={  
	"net":"wifi",  
	"os":"iOS",  
	"phoneVersion":"iPhone",
}
```

![21.webp](%E5%88%A9%E7%94%A8%E6%A8%A1%E6%9D%BF%E9%9B%B6%E5%9F%BA%E7%A1%80%E5%86%99%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC%EF%BC%88%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%EF%BC%89%2012d1fc355aa9817391cdd1f5031ad5da/e23933bd-dd11-4095-933f-49c98c572313.png)