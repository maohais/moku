# 支持WxPusher微信推送，使用教程

# **简述**

聚合脚本新增新脚本步骤：

1.复制并运行最新的更新脚本（UPDATE.js)脚本自动新增最新表格及配置

2.复制最新的签到脚本，并添加网络API服务和加入定时任务（若需要邮箱推送需添加邮箱API）

文章中的代码已放入github仓库中

```
https://github.com/imoki
```

# **准备工作(需要apptoken和uid)**

创建推送应用，并复制apptoken，如apptoken

```
https://wxpusher.zjiecode.com/admin/main
```

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpicsXDaXxeLfvYeswyTdol3ld4bIy3h2lkZsmpD4NmA1pn7C5ArOvQndlbN9fK6kHXKXGSsnWKib9gA/640?wx_fmt=png&from=appmsg&wxfrom=13](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpicsXDaXxeLfvYeswyTdol3ld4bIy3h2lkZsmpD4NmA1pn7C5ArOvQndlbN9fK6kHXKXGSsnWKib9gA/640?wx_fmt=png&from=appmsg&wxfrom=13)

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpicsXDaXxeLfvYeswyTdol3lF4B4PxicHcr27iabVs6g1gExjZp2fADibQmiatUraxWpDXTnBwYUYqMWlA/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpicsXDaXxeLfvYeswyTdol3lF4B4PxicHcr27iabVs6g1gExjZp2fADibQmiatUraxWpDXTnBwYUYqMWlA/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

在应用管理中进行微信扫码

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpicsXDaXxeLfvYeswyTdol3l2nWiaXCpibBnqh3ocka9YETfMjxJECy3icdIEQgPFTVEAdsnhmy2TtgicA/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpicsXDaXxeLfvYeswyTdol3l2nWiaXCpibBnqh3ocka9YETfMjxJECy3icdIEQgPFTVEAdsnhmy2TtgicA/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

到用户列表中复制uid，如uid

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpicsXDaXxeLfvYeswyTdol3l6UEiaCDiaEqgAtt3DuD2Crdf7lpgy28WFA3h5ZVMdHzB2FzsBVsCJlibQ/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpicsXDaXxeLfvYeswyTdol3l6UEiaCDiaEqgAtt3DuD2Crdf7lpgy28WFA3h5ZVMdHzB2FzsBVsCJlibQ/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

# **实际操作**

1.进入github中复制最新的UPDATE.js的代码（此为更新脚本，运行则会自动新增表格配置、不会覆盖原有信息）

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp0MwsciaEA8wUlxaRPATzfFN4ozlpMn7qUkvxxtWW1urQu6K7Mz6GNbgQ/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp0MwsciaEA8wUlxaRPATzfFN4ozlpMn7qUkvxxtWW1urQu6K7Mz6GNbgQ/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp)

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp0ooVEnOwU08HWSAEtzUUg5LYqOHu1b7LbQqoQnaa7dZjIQs2SDww4Wg/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp0ooVEnOwU08HWSAEtzUUg5LYqOHu1b7LbQqoQnaa7dZjIQs2SDww4Wg/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp)

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp0STUucDT2YjfuRBE7QmKcn4ZyaF3OE9VVAEJs41iap7OaibskvZPrZUfw/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp0STUucDT2YjfuRBE7QmKcn4ZyaF3OE9VVAEJs41iap7OaibskvZPrZUfw/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp)

2.将复制的UPDATE.js代码粘贴到脚本编辑器中，点击"保存"，再点击运行。当UPDATE脚本运行完后，会自动生成配置表格。

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp0qx3wrL78IvziaZrMsJN61TAKV0ncYlQJ3v0lciannI9vEibGBnZLlA5oA/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp0qx3wrL78IvziaZrMsJN61TAKV0ncYlQJ3v0lciannI9vEibGBnZLlA5oA/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp)

3.进入github中，复制最新的PUSH.js。点击"+"将代码粘贴到编辑器内，并点击保存。（如果第一次用PUSH脚本，记得添加服务，网络API和邮箱API。按图所示，点击“服务”-“添加服务”，再点击“网络API”对应的“添加”按钮。）

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp03f9qwApDzHjekmflOHiamnibPkpE3plAicmSFGkK5iarZ13KozPxJxqGqg/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp03f9qwApDzHjekmflOHiamnibPkpE3plAicmSFGkK5iarZ13KozPxJxqGqg/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp)

4.填写PUSH表的内容，填的上述准备工作中获得到的所需要的值。

wxpusher栏填写需要两个参数（以|分割）：appToken|uid

（4.1. 可对点击“运行”进行测试。此测试步骤可忽略）

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpicsXDaXxeLfvYeswyTdol3lsR6g4LB3CepWycicDLtMpLAHtuibEd8afrpm8btYu7j0ESUNe39v2Jtg/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpicsXDaXxeLfvYeswyTdol3lsR6g4LB3CepWycicDLtMpLAHtuibEd8afrpm8btYu7j0ESUNe39v2Jtg/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp85RicFlUichzJgmlKAmXABFKdoxaCkpZN77zLWdr4ufZCPTsiaTUDBmQTvJ0oWw0RCJOia01Uv8gRvicg/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp85RicFlUichzJgmlKAmXABFKdoxaCkpZN77zLWdr4ufZCPTsiaTUDBmQTvJ0oWw0RCJOia01Uv8gRvicg/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

5.如果是第一次使用PUSH.js脚本记得添加到定时任务中。依次点击“高级开发”-“定时任务”，将刚刚的脚本添加到定时任务中。点击“创建任务”-“每天”，选择此脚本。此时就完成了，每天指定时间将会推送。

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp0LxvUWgcicOU8REYUTgF5YoH4b9g7be2KhMXM8E851ZvQcpqoYlnmfdg/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp0LxvUWgcicOU8REYUTgF5YoH4b9g7be2KhMXM8E851ZvQcpqoYlnmfdg/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp)

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp08gsd9S83P6MjibUiaaAHbdm4VHzOMMUatKXEBYUL47agF985f7BLQkqg/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp08gsd9S83P6MjibUiaaAHbdm4VHzOMMUatKXEBYUL47agF985f7BLQkqg/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp)

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9RicR4Ek2MYvy0Nll9Sh21x16UDEgnAO4jPSoOj8ukFd0B9f1149G0nic0uices5ECFibmgtmLCvgicUA/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9RicR4Ek2MYvy0Nll9Sh21x16UDEgnAO4jPSoOj8ukFd0B9f1149G0nic0uices5ECFibmgtmLCvgicUA/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp)

6.**分离式推送使用方法（已使用PUSH.js推送脚本的可忽略）**

根据”[**分离式推送**](%E5%88%86%E7%A6%BB%E5%BC%8F%E6%8E%A8%E9%80%81%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%EF%BC%88%E5%B7%B2%E4%BD%BF%E7%94%A8PUSH%20js%E6%8E%A8%E9%80%81%E8%84%9A%E6%9C%AC%E7%9A%84%E5%8F%AF%E5%BF%BD%E7%95%A5%EF%BC%89%2012d1fc355aa981b7b254fe4ccffd1ba9.md)“文章进行配置

7.如何使用定时自动调整（更安全，推荐使用）

根据”[**智能金山文档调整定时**](../../%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%E6%99%BA%E8%83%BD%E8%B0%83%E6%95%B4%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E6%97%B6%E9%97%B4%E7%A8%8B%E5%BA%8F%2012d1fc355aa9813b8c30c6d9caa0c739.md)“文章进行配置