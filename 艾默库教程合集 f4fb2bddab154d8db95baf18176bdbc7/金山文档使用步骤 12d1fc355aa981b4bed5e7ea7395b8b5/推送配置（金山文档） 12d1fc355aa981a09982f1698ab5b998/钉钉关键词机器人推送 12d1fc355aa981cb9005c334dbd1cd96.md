# 钉钉关键词机器人推送

仅用于测试和学习研究，禁止用于商业用途，不能保证其合法性，准确性，完整性和有效性，请根据情况自行判断。本人对任何脚本问题概不负责，包括但不限于由任何脚本错误导致的任何损失或损害。

# **简述**

本文利用钉钉关键词机器人进行推送，通过将钉钉关键词机器人的access_token粘贴到聚合脚本PUSH推送表的钉钉的推送识别号中，即可实现钉钉关键词机器人推送。若不需要钉钉机器人推送，可忽略本文。

本文不需要代码知识，不需要自备服务器，按照文章步骤即可零成本轻松完成，适合零基础使用者。

文章中的代码已放入github仓库中，更多及最新代码将会在仓库中更新

```
https://github.com/imoki
```

“金山文档”中AirScript能够执行用户编写的js代码，并且可以设置定时执行。因此通过编写指定代码，并加入自动到定时任务中，即可无成本自动执行所需脚本。

此段是官方的概述。金山文档 AirScript 是一个简单快速的轻量级脚本应用开发平台，它基于云技术构建，可让您快速轻松地创建与金山文档 Office 文件交互的业务应用。我们在金山文档的组件中提供了代码编辑器，您的代码将会安全地运行在我们的服务端上。您可以使用现代 JavaScript 语言编写逻辑代码，并可以调用 AirScript 内置强大的组件（表格）API 来构建特定场景的解决方案。目前在国内业界中尚未出现类似的产品，金山文档 AirScript 是国内首家提供该服务的平台。

# **①用钉钉APP创建内部群**

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp95Iibdll3gjIRQ6MX4F4tWaZJ3qI4Hr6b1Q9PE59yksLpuDXUZJGpKREZzQ6lnVicn1Yxym0ODULqg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp95Iibdll3gjIRQ6MX4F4tWaZJ3qI4Hr6b1Q9PE59yksLpuDXUZJGpKREZzQ6lnVicn1Yxym0ODULqg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp95Iibdll3gjIRQ6MX4F4tWaIPeZb2HnNaXZfWn4iaMQmHDwVvHviczAUEgjDgyXFrfiba5SR4k6BVjrw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp95Iibdll3gjIRQ6MX4F4tWaIPeZb2HnNaXZfWn4iaMQmHDwVvHviczAUEgjDgyXFrfiba5SR4k6BVjrw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp95Iibdll3gjIRQ6MX4F4tWaIxploD8WSkWcFqpQzs6FpX523ickpWZCVJSPO4d5TGJMIrC6hTu1Y2w/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp95Iibdll3gjIRQ6MX4F4tWaIxploD8WSkWcFqpQzs6FpX523ickpWZCVJSPO4d5TGJMIrC6hTu1Y2w/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp95Iibdll3gjIRQ6MX4F4tWaBBxQaHNvPaDOZqXnCuOEgXBJo2JAZvbQibt2cMMwEgPqghnd7tf4tOQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp95Iibdll3gjIRQ6MX4F4tWaBBxQaHNvPaDOZqXnCuOEgXBJo2JAZvbQibt2cMMwEgPqghnd7tf4tOQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

按照如上步骤用手机的钉钉APP创建出内部群，后续将会在此群内创建关键词机器人。（由于我用PC端的钉钉软件无法创建内部群，因此以上步骤是使用移动端的钉钉APP创建的内部群）。

下面用电脑的钉钉软件创建关键词机器人，并复制所需的access_token。

# **创建机器人并获取的token**

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpibPIPWaKW1fByGTEIib5RvOKgA4EKzP3ZUuEgkjibJ9a3NliawTmOk0aA8AD8Kgiae0gUcRica9BnpDLTg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpibPIPWaKW1fByGTEIib5RvOKgA4EKzP3ZUuEgkjibJ9a3NliawTmOk0aA8AD8Kgiae0gUcRica9BnpDLTg/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpibPIPWaKW1fByGTEIib5RvOKLVysMLdHibT3Lq4tvz3uwUYqSLKteF4j1HQlUlbOsibQb668jCFOnH1Q/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpibPIPWaKW1fByGTEIib5RvOKLVysMLdHibT3Lq4tvz3uwUYqSLKteF4j1HQlUlbOsibQb668jCFOnH1Q/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpibPIPWaKW1fByGTEIib5RvOKiauFHBMRwetUsaFGtib1y0MWefnAVEVLrTVtv16fXBmuMg9eOp9q8n1g/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpibPIPWaKW1fByGTEIib5RvOKiauFHBMRwetUsaFGtib1y0MWefnAVEVLrTVtv16fXBmuMg9eOp9q8n1g/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpibPIPWaKW1fByGTEIib5RvOKqGYk76pTths1ePdLxFgtI5ibb50eSaYUEa10vTZRwYbCtkiaN8xWtYcQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpibPIPWaKW1fByGTEIib5RvOKqGYk76pTths1ePdLxFgtI5ibb50eSaYUEa10vTZRwYbCtkiaN8xWtYcQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpibPIPWaKW1fByGTEIib5RvOKQKiaHSZRxPbWg8oYxE7C7BH3v8CibTO1d2SiafrKicenqmZua8pNZqwUCA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpibPIPWaKW1fByGTEIib5RvOKQKiaHSZRxPbWg8oYxE7C7BH3v8CibTO1d2SiafrKicenqmZua8pNZqwUCA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpibPIPWaKW1fByGTEIib5RvOKSszQAPQNA1JerHsST1ecUPyMSzfsiameMwADqG4Zfdbycxk7qEB1XBw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpibPIPWaKW1fByGTEIib5RvOKSszQAPQNA1JerHsST1ecUPyMSzfsiameMwADqG4Zfdbycxk7qEB1XBw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpibPIPWaKW1fByGTEIib5RvOKDKXTNpmcvuSTTJiaVn27LWic1wsxg7mFtagIjXO0XM7wIB3mPib3vDLkQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpibPIPWaKW1fByGTEIib5RvOKDKXTNpmcvuSTTJiaVn27LWic1wsxg7mFtagIjXO0XM7wIB3mPib3vDLkQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpibPIPWaKW1fByGTEIib5RvOKmmscXJE2L4cCRgVI1Lycch0DeEuICibZxGk4y3VkXq2CppFSa5mESsw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpibPIPWaKW1fByGTEIib5RvOKmmscXJE2L4cCRgVI1Lycch0DeEuICibZxGk4y3VkXq2CppFSa5mESsw/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

此步骤用电脑的钉钉软件创建关键词机器人，其中自定义关键词的文本框内需要填写接收到的推送消息中必定包含的文字。(由于聚合脚本的消息默认会以方头括号包裹标题，如【阿里云盘】，因此关键词填写了左半边的方头括号)

然后需要复制关键词机器人的access_token的值，如上方的：xxxxxxxx。这个值后面的表格中需要用到。

# **聚合脚本表格配置钉钉推送**

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp95Iibdll3gjIRQ6MX4F4tWacAGibqrA67TnXf375ribvCTRicfqlKdiapOccWADSF1Cu37kFp3OF9CKUQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp95Iibdll3gjIRQ6MX4F4tWacAGibqrA67TnXf375ribvCTRicfqlKdiapOccWADSF1Cu37kFp3OF9CKUQ/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

如上图所示，在推送表(PUSH)中的dingtalk所在的行的推送识别号中填入刚刚获取到的access_token值，并将是否推选选项改为是。此时就配置好钉钉推送了，可以运行脚本进行测试，脚本运行完后，内部群的关键词机器人就会发送运行结果的消息推送了。