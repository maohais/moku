# 金山文档使用步骤

---

<aside>
😀 **请使用AirScript 1.0脚本类型**

具体每个脚本的**签到ck配置**请查看“[具体签到脚本配置教程](%E5%85%B7%E4%BD%93%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC%E9%85%8D%E7%BD%AE%E6%95%99%E7%A8%8B%EF%BC%88%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%E3%80%81%E9%80%82%E7%94%A8%E9%9D%92%E9%BE%99%EF%BC%89%2012d1fc355aa9812c8968ff0c00913633.md)”文章

**脚本问题**请查看这里的文章“[脚本问题汇总](%E8%84%9A%E6%9C%AC%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB%2012d1fc355aa981c995c7f37bcd00fa42.md)”

金山文档官网：

```jsx
https://www.kdocs.cn/latest
```

# 目录

[**利用模板零基础写签到脚本（金山文档）**](%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4%2012d1fc355aa981b4bed5e7ea7395b8b5/%E5%88%A9%E7%94%A8%E6%A8%A1%E6%9D%BF%E9%9B%B6%E5%9F%BA%E7%A1%80%E5%86%99%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC%EF%BC%88%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%EF%BC%89%2012d1fc355aa9817391cdd1f5031ad5da.md)

[推送配置（金山文档）](%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4%2012d1fc355aa981b4bed5e7ea7395b8b5/%E6%8E%A8%E9%80%81%E9%85%8D%E7%BD%AE%EF%BC%88%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%EF%BC%89%2012d1fc355aa981a09982f1698ab5b998.md)

</aside>

# 📝 **聚合脚本简述**

聚合脚本初次使用步骤：（本文展示此步骤）

1. 复制并运行最新的更新脚本（UPDATE.js)会自动新增最新表格及配置
2. 复制所需的签到脚本，并添加网络API服务和加入定时任务

在原有的聚合脚本中添加新脚本步骤：（本文不展示此步骤，仅供了解）

1. 复制并运行最新的更新脚本（UPDATE.js)会自动新增最新表格及配置
2. 复制最新的签到脚本，并添加网络API服务和加入定时任务

仓库：

[https://github.com/imoki/sign_script](https://github.com/imoki/sign_script)

```
https://github.com/imoki
```

本文不需要代码知识，不需要自备服务器，按照文章步骤即可零成本轻松完成，适合零基础使用者。

# 聚合脚本优势

1.所有脚本及配置表格汇集在一个文档中，利于统一管理和配置

2.方便后续更新脚本，仅需运行UPDATE脚本即可自动新增最新表格及配置，不再需要手动新建表格框架

3.方便定时任务的添加与查看

4.支持仅推送错误消息、推送昵称、多种推送方式等

5.配置灵活快捷，利于新增脚本及新配置功能

6.支持多脚本共用同一个表格，如WPS(轻量版)、WPS(客户端版)、WPS(稻壳版)脚本共用名称为wps的表格。

“金山文档”中AirScript能够执行用户编写的js代码，并且可以设置定时执行。因此通过编写指定代码，并加入自动到定时任务中，即可无成本自动执行所需脚本。

# **聚合脚本介绍**

![1.webp](%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4%2012d1fc355aa981b4bed5e7ea7395b8b5/da1c958e-8768-4fc4-b514-1e524cfaf25e.png)

![2.webp](%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4%2012d1fc355aa981b4bed5e7ea7395b8b5/40fb26d1-074c-4e2a-b2a4-e787e4ea9d7d.png)

![3.webp](%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4%2012d1fc355aa981b4bed5e7ea7395b8b5/eb75f498-222c-44ed-bb5c-b557af36ddb1.png)

聚合脚本中的表格是通过运行UPDATE脚本自动生成的。表格介绍如下。

主配置表格(CONFIG):

对脚本进行统一管理，能配置是否为仅推送错误消息，能配置推送内容是用"昵称"还是"单元格Ax"的格式指代账户。

推送表格(PUSH):

对推送的方式进行配置。推送识别号如pushplus填token，Server酱填key。若需要邮箱推送方式，还需要配置邮箱表（EMAIL）。

分配置表格（如:aliyundrive_multiuser、wps等等）：

是具体对应脚本的配置。如:aliyundrive_multiuser指代（阿里云盘（多用户版））、wps指代（WPS（轻量版、客户端版、稻壳版）共有的配置）。表格中的cookie填脚本所需的消息，如阿里云盘（多用户版）填的为refresh_token，wps中填wps_sid。

# **实际操作**

如图所示创建表格。

1.浏览器访问金山文档网址，并点击新建

```
https://www.kdocs.cn/latest?from=docs
```

2.点击“表格”

3.点击“空白表格”

![4.webp](%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4%2012d1fc355aa981b4bed5e7ea7395b8b5/b0b6e9a1-f501-4acc-b08d-682e8b858a51.png)

![5.webp](%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4%2012d1fc355aa981b4bed5e7ea7395b8b5/933e46dc-010a-42fc-83d2-f4269afaafa3.png)

4.依次点击“效率”-“高级开发”-“AirScript脚本编辑器”

![6.webp](%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4%2012d1fc355aa981b4bed5e7ea7395b8b5/bd0a97db-ac9d-4a14-885c-aa4b5cbe2160.png)

5.依次点击“创建脚本”-“文档共享脚本”(需要AirScript 1.0版本)

![7.webp](%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4%2012d1fc355aa981b4bed5e7ea7395b8b5/ab9f9a80-5aca-4cb7-81e3-7df6b2593f9d.png)

6.进入github中复制最新的UPDATE.js的代码

![8.webp](%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4%2012d1fc355aa981b4bed5e7ea7395b8b5/29063153-83f1-4bbc-ad47-2c52d8b31ae6.png)

![9.webp](%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4%2012d1fc355aa981b4bed5e7ea7395b8b5/b6e191ac-305e-4f2b-9bb2-20d24a1e700e.png)

![10.webp](%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4%2012d1fc355aa981b4bed5e7ea7395b8b5/9be5751e-8048-4652-a0cf-dc7d5e31b014.png)

7.将复制的UPDATE代码粘贴到脚本编辑器中，点击"保存"，再点击运行。

![11.webp](%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4%2012d1fc355aa981b4bed5e7ea7395b8b5/998acb1b-bdd0-4573-b41b-0292f32153cf.png)

8.当UPDATE脚本运行完后，会自动生成如上的配置表格。（UPDATE.js是更新脚本，属于一次性脚本，当生成表格配置后就已经不需要了，可以自己选择是否要删除。建议不进行删除，当清除某列及某列以下部分、某行及某行以右部分，希望恢复原来表格，则运行UPDATE.js脚本会自动补全信息）

![12.webp](%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4%2012d1fc355aa981b4bed5e7ea7395b8b5/07d5bab7-3b19-49b6-bc85-f84ededb234d.png)

9.进入github中，依次复制最新脚本代码，如aliyundrive_multiuser.js，noteyoudao.js、tieba.js等。点击"+"依次将代码粘贴到编辑器内，并点击保存。（仅需添加自己需要的脚本即可，如只需要阿里云盘脚本，则仅添加阿里云盘脚本。）

![13.webp](%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4%2012d1fc355aa981b4bed5e7ea7395b8b5/78f1ec0b-16d0-4a1b-8cf0-c8ca46aa7034.png)

![14.webp](%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4%2012d1fc355aa981b4bed5e7ea7395b8b5/b5621215-ada1-4966-91a5-0753eb06b3b1.png)

![15.webp](%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4%2012d1fc355aa981b4bed5e7ea7395b8b5/b342f825-20c7-4e4e-a413-bad4136aae31.png)

![16.webp](%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4%2012d1fc355aa981b4bed5e7ea7395b8b5/67516008-aba2-48c3-8fff-1d3c66ac7b10.png)

10.按图所示，点击“服务”-“添加服务”，再点击“网络API”对应的“添加”按钮。每个脚本都需要添加。若需要邮箱推送，则添加“邮箱API”。

![17.webp](%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4%2012d1fc355aa981b4bed5e7ea7395b8b5/f3ff4ccd-7a82-4ed1-8b09-dc941a9eb71b.png)

11.根据需要写每个分配置表的内容，如aliyundrive_multiuser中第一列填的是refresh_token。主配置表（CONFIG）及推送表（PUSH）根据自身需求填写

（12. 可对点击“运行”进行测试。此测试步骤可忽略）

![18.webp](%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4%2012d1fc355aa981b4bed5e7ea7395b8b5/eb94102f-84c0-468d-b34c-92eebe97db25.png)

13.依次点击“高级开发”-“定时任务”，将刚刚的脚本添加到定时任务中。

![19.webp](%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4%2012d1fc355aa981b4bed5e7ea7395b8b5/aeb875cc-6522-4ed5-9618-b163bad97248.png)

14.依次点击“创建任务”-“每天”，选择对应的脚本。每个脚本都能创建定时任务。此时就完成了，每天指定时间将会执行脚本。（仅需添加希望定时执行的脚本即可。若之后不想定时执行某个任务，可删除此定时任务，或将表格配置中的是否执行改为“否”）

![20.webp](%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4%2012d1fc355aa981b4bed5e7ea7395b8b5/7533f307-807c-4072-ab99-75aecf44bddf.png)

![22.webp](%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4%2012d1fc355aa981b4bed5e7ea7395b8b5/3c8dc7ac-7707-47d6-8400-d88831f8233f.png)

![21.webp](%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4%2012d1fc355aa981b4bed5e7ea7395b8b5/40cb49fa-bbea-407d-a336-83481cef0540.png)

15.如何使用推送？

根据**”[分离式推送使用方法](%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4%2012d1fc355aa981b4bed5e7ea7395b8b5/%E6%8E%A8%E9%80%81%E9%85%8D%E7%BD%AE%EF%BC%88%E9%87%91%E5%B1%B1%E6%96%87%E6%A1%A3%EF%BC%89%2012d1fc355aa981a09982f1698ab5b998/%E5%88%86%E7%A6%BB%E5%BC%8F%E6%8E%A8%E9%80%81%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%EF%BC%88%E5%B7%B2%E4%BD%BF%E7%94%A8PUSH%20js%E6%8E%A8%E9%80%81%E8%84%9A%E6%9C%AC%E7%9A%84%E5%8F%AF%E5%BF%BD%E7%95%A5%EF%BC%89%2012d1fc355aa981b7b254fe4ccffd1ba9.md)“**文章进行配置即可