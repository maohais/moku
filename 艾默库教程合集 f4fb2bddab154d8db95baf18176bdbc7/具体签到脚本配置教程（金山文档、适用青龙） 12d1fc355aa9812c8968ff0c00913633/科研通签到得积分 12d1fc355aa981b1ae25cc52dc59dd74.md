# 科研通签到得积分

# **简述**

聚合脚本新增新脚本步骤：

1.复制并运行最新的更新脚本（UPDATE.js)脚本自动新增最新表格及配置

2.复制最新的签到脚本，并添加网络API服务和加入定时任务（若需要邮箱推送需添加邮箱API）

文章中的代码已放入github仓库中

```
https://github.com/imoki
```

(文末会用临时文本的方式附上代码，以利于访问github较慢的使用者采用。由于后期会不定期更新代码功能，因此建议使用者从github上复制最新的代码)

# **准备工作**

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpibSVhMuI8Khu4VU4eOXXScUaaxALrpwPGDnmekQ5t7LzqqfGN6RxibhgDWaqT2xoJmuKE7kibIKUqeA/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpibSVhMuI8Khu4VU4eOXXScUaaxALrpwPGDnmekQ5t7LzqqfGN6RxibhgDWaqT2xoJmuKE7kibIKUqeA/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

需要Cookie。抓取所需的值，如图复制所需要的值，如:xxxxxxxx。此值后面表格中需要用到。（[IOS手机端获取所需要的值的方法可参考->点击此处跳转到这篇文章](http://mp.weixin.qq.com/s?__biz=MzU4MDgxMzU4NA==&mid=2247489097&idx=1&sn=0949cbf4dce99af820eca978702b330a&chksm=fd504036ca27c920700e045ebe7d3c690cfa9e928d13837af60fe6ce7c1671bd5f844d545ecc&scene=21#wechat_redirect)）

文字步骤如下：

1.第一步，浏览器访问科研通，网址为

```
https://www.ablesci.com/
```

按键盘的F12，会唤起下方的开发者工具

2.第二步，点击开发者工具中的"NetWork"(中文名叫"网络")

3.第三步，点击任意一个含有cookie的包

4.第四步，右侧找到"Cookie"并复制，如图中的xxxxxxxx

# **实际操作**

1.进入github中复制最新的UPDATE.js的代码（此为更新脚本，运行则会自动新增表格配置、不会覆盖原有信息）

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp0MwsciaEA8wUlxaRPATzfFN4ozlpMn7qUkvxxtWW1urQu6K7Mz6GNbgQ/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp0MwsciaEA8wUlxaRPATzfFN4ozlpMn7qUkvxxtWW1urQu6K7Mz6GNbgQ/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp)

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp0ooVEnOwU08HWSAEtzUUg5LYqOHu1b7LbQqoQnaa7dZjIQs2SDww4Wg/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp0ooVEnOwU08HWSAEtzUUg5LYqOHu1b7LbQqoQnaa7dZjIQs2SDww4Wg/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp)

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp0STUucDT2YjfuRBE7QmKcn4ZyaF3OE9VVAEJs41iap7OaibskvZPrZUfw/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp0STUucDT2YjfuRBE7QmKcn4ZyaF3OE9VVAEJs41iap7OaibskvZPrZUfw/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp)

2.将复制的UPDATE.js代码粘贴到脚本编辑器中，点击"保存"，再点击运行。当UPDATE脚本运行完后，会自动生成配置表格。

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp0qx3wrL78IvziaZrMsJN61TAKV0ncYlQJ3v0lciannI9vEibGBnZLlA5oA/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp0qx3wrL78IvziaZrMsJN61TAKV0ncYlQJ3v0lciannI9vEibGBnZLlA5oA/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp)

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp0sH4zmwftO9B4wfwDbn2qdcVzxSAsTc1nr00ibeWickJcPIO7OvkfN4kw/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp0sH4zmwftO9B4wfwDbn2qdcVzxSAsTc1nr00ibeWickJcPIO7OvkfN4kw/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp)

3.进入github中，复制所需脚本代码，如kyt.js。点击"+"将代码粘贴到编辑器内，并点击保存。

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpibSVhMuI8Khu4VU4eOXXScU7k3mfniaj5Ficgnd7dtFGSYcMjrOqddgiapice300jND0lzXiapTeIBgGjQ/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpibSVhMuI8Khu4VU4eOXXScU7k3mfniaj5Ficgnd7dtFGSYcMjrOqddgiapice300jND0lzXiapTeIBgGjQ/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpibSVhMuI8Khu4VU4eOXXScUqFFRFxLtw4tR2CTo6176vqyabHbrld6TxsP6c0sQvapI5BwLnJsOmQ/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpibSVhMuI8Khu4VU4eOXXScUqFFRFxLtw4tR2CTo6176vqyabHbrld6TxsP6c0sQvapI5BwLnJsOmQ/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp0XTA8lziaGEgQRePuVJDBAE9RicEUYoRdCricCwMIe7hMYrjSicF20xNzrQ/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp0XTA8lziaGEgQRePuVJDBAE9RicEUYoRdCricCwMIe7hMYrjSicF20xNzrQ/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp)

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpibSVhMuI8Khu4VU4eOXXScUSbleeIDIOgWAibD0M9XB7LoUEfcgmRRX8xgTy9X02MJjX6deg91ZbDQ/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpibSVhMuI8Khu4VU4eOXXScUSbleeIDIOgWAibD0M9XB7LoUEfcgmRRX8xgTy9X02MJjX6deg91ZbDQ/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

4.按图所示，点击“服务”-“添加服务”，再点击“网络API”对应的“添加”按钮。

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp03f9qwApDzHjekmflOHiamnibPkpE3plAicmSFGkK5iarZ13KozPxJxqGqg/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp03f9qwApDzHjekmflOHiamnibPkpE3plAicmSFGkK5iarZ13KozPxJxqGqg/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp)

5.填写分配置表的内容，如kyt表中第一列填的上述准备工作中获得到的所需要的值。

（5.1. 可对点击“运行”进行测试。此测试步骤可忽略）

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpibSVhMuI8Khu4VU4eOXXScUSbleeIDIOgWAibD0M9XB7LoUEfcgmRRX8xgTy9X02MJjX6deg91ZbDQ/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4YnqicpibSVhMuI8Khu4VU4eOXXScUSbleeIDIOgWAibD0M9XB7LoUEfcgmRRX8xgTy9X02MJjX6deg91ZbDQ/640?wx_fmt=png&from=appmsg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1)

6.依次点击“高级开发”-“定时任务”，将刚刚的脚本添加到定时任务中。

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp0LxvUWgcicOU8REYUTgF5YoH4b9g7be2KhMXM8E851ZvQcpqoYlnmfdg/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp0LxvUWgcicOU8REYUTgF5YoH4b9g7be2KhMXM8E851ZvQcpqoYlnmfdg/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp)

7.点击“创建任务”-“每天”，选择此脚本。此时就完成了，每天指定时间将会执行脚本。

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp08gsd9S83P6MjibUiaaAHbdm4VHzOMMUatKXEBYUL47agF985f7BLQkqg/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9KWIjLlsFk7Vhjs2icvfNp08gsd9S83P6MjibUiaaAHbdm4VHzOMMUatKXEBYUL47agF985f7BLQkqg/640?wx_fmt=other&from=appmsg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp)

[https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9RicR4Ek2MYvy0Nll9Sh21x16UDEgnAO4jPSoOj8ukFd0B9f1149G0nic0uices5ECFibmgtmLCvgicUA/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp](https://mmbiz.qpic.cn/sz_mmbiz_png/zZAR4Ynqicp9RicR4Ek2MYvy0Nll9Sh21x16UDEgnAO4jPSoOj8ukFd0B9f1149G0nic0uices5ECFibmgtmLCvgicUA/640?wx_fmt=other&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp)

8.**如何添加推送代码（已使用PUSH.js推送脚本的可忽略）**

参考分离式推送

9.如何使用定时自动调整

参考金山文档智能调时